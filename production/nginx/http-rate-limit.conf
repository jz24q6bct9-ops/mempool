# Rate Limiting Configuration for Mempool API
# Include this file in your nginx.conf http block
#
# This configuration protects your Mempool instance from abuse by limiting
# the number of requests per second from each IP address.

# General API rate limit - 10 requests per second with burst of 20
# This covers most API endpoints and provides good protection against abuse
limit_req_zone $binary_remote_addr zone=api_general:10m rate=10r/s;

# Expensive operations rate limit - 1 request per second with burst of 5
# Applied to endpoints that are computationally expensive or database-intensive
limit_req_zone $binary_remote_addr zone=api_expensive:10m rate=1r/s;

# WebSocket rate limit - 5 connections per second
# Prevents WebSocket connection flooding
limit_req_zone $binary_remote_addr zone=api_websocket:10m rate=5r/s;

# Transaction broadcast rate limit - 1 request per second
# Stricter limit for transaction broadcasting to prevent spam
limit_req_zone $binary_remote_addr zone=api_broadcast:10m rate=1r/s;

# Status code for rate limit exceeded
# Returns 429 Too Many Requests when limit is exceeded
limit_req_status 429;

# Log level for rate limit rejections
# Set to 'warn' to log rate limit events, or 'info' for less verbosity
limit_req_log_level warn;
